---
title: "Bonanza Creek Snowshoe Hare Report"
author: "Conner Smith"
date: "11/3/2021"
output: 
  html_document: 
    toc: yes
    toc_depth: 2
    theme: flatly
    code_folding: hide
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)

# Attach packages.
library(tidyverse)
library(here)
library(lubridate)
library(ggbeeswarm)
library(janitor)
library(kableExtra)
library(broom)
```

# **Introduction**

This study explores population dynamics and characteristics of Snowshoe Hares measured at the Bonanza Creek Experimental Forest (Long Term Ecological Research site). The analysis looks at the counts and sizes of juvenile snowshoe hares recorded from 1998 - 2012 ... 

*Data citation: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14*

```{r, include = FALSE}
# Read in the snowshoe hare data 

hares <- read_csv(here("data", "bonanza_hares.csv"))
  
```

# **Data and Methods**

A 3 - 4 sentence section in which you briefly describe the data, including citation & credit as needed, and provide an overview of the main analysis, statistical methods and tools used.

## **Initial Investigation**

This section includes a summary of the hare count by year.

#### **Figure 1: Count of Bonanza LTER Juvenile Snowshoe Hare Trappings by Year**

```{r}
# Count the total number of juvenile hare trappings (`summarize()` during each year of the study (`group_by()`), and create a finalized data visualization of the counts by year.

hares_juvenile <- hares %>% 
  filter(age == "j") %>% 
  mutate(date_new = mdy(date)) %>%
  mutate(year = year(date_new)) %>% 
  group_by(year)

juvenile_summary <- hares_juvenile %>% 
  count(year) %>% 
  rename(trappings = "n")
  
ggplot(data = hares_juvenile, aes(x = year)) +
  geom_histogram(fill = "slategray2",
                 show.legend = FALSE, binwidth = 0.5) +
  theme_bw() +
  scale_x_continuous(breaks = 1998:2012)+
  labs(x = "Year", y = "Count of Trappings", 
       title = "Juvenile Snowshoe Hare Trappings (1998-2012)")

# Including calculation of mean/median values for the description without generating a summary table.

juvenile_mean <- mean(juvenile_summary$trappings)
juvenile_median <- median(juvenile_summary$trappings)
juvenile_max <- max(juvenile_summary$trappings)
```

**Figure 1: Count of Bonanza LTER Juvenile Snowshoe Hare Trappings by Year.** *This graph shows the spread of juvenile Snowshoe Hare trappings at the Bonanza site between 1998 and 2012.*

The fewest number of juvenile hares (2) were trapped in 2010 and the highest number (126) were trapped in 2009. The average annual hare trappings is around `r round(juvenile_mean)` across the 12 years where juvenile hares were trapped (Note: this calculation does not include the years where no juvenile hares were trapped: 1998; 2002; 2009). The median value is `r round(juvenile_median)`, which falls across two years (2003 and 2011). trappings were highest between 1999 and 2000. This shows an overall decline in the number of juvenile hares trapped at the research site. In order to more confidently assert that this represents an actual decline in the juvenile hare population, the number of traps and time spent trapping would have to be standardized across all study years and sites.

#### **Figure 2: Weight Distribution of Bonanza LTER Juvenile Snowshoe Hares by Site**

```{r}
# Compare juvenile hare weights by sex and site (grid), include groups where these variables are not recorded (`NA`). Using a jitter plot to show these comparisons. 

juvenile_weight <- hares_juvenile %>% 
  select(grid, sex, weight) %>% 
  mutate(grid = case_when(grid == "bonbs" ~ "Bonanza Black Spruce",
                               grid == "bonmat" ~ "Bonanza Mature",
                               grid == "bonrip" ~ "Bonanza Riparian")) %>%
  mutate(sex = case_when(sex == "f" ~ "Female",
                               sex == "m" ~ "Male"))

ggplot(data = juvenile_weight, aes(x = sex, y = weight)) +
  geom_jitter(aes(color = sex), width = 0.2, show.legend = FALSE) +
  facet_wrap(~grid) +
  scale_color_manual(values = c("skyblue3", 
                               "slateblue3", 
                               "slategray3")) +
  theme_bw() +
  labs(x = "Sex", y = "Weight (grams)", 
       title = "Juvenile Hare Weight by Sex and Site")
```

**Figure 2: Weigh of Bonanza LTER Juvenile Snowshoe Hares by Site.** *This graph shows the weight distribution of Snowshoe Hare trappings at different site types broken out by hare sex.*

Figure 2 shows that more hares were trapped at the Bonanza Riparian site compared to the Bonanza Black Spruce and Mature sites. It also shows that  overall, the weight differences between juvenile males and female appears to be minimal. The table below provides summary statistics of this data. 

**Table 1: Summary Statistics of Bonanza Hare Weight.** *This table shows summary statistics for hare weights based on trap site and sex.*

```{r}
# Creating a summary table comparing juvenile weights by sex and site using `kable()`. 

juvenile_stats <- juvenile_weight %>% 
  group_by(grid, sex) %>% 
  summarize(trappings = n(),
            mean_weight = mean(weight, na.rm = TRUE),
            median_weight = median(weight, na.rm = TRUE),
            sd_weight = sd(weight, na.rm = TRUE)) 

juvenile_stats %>% 
kable(col.names = c("Site", 
                    "Sex",
                    "Trappings",
                    "Mean Weights (g)",
                    "Median Size (g)",
                    "Standard Deviation (g)"), digits = 2) %>% 
  kable_styling(full_width = FALSE)

```

A 2 - 3 sentence comprehensive statement of the means comparison, including at least:
The actual difference in means
Effect size (Cohen's *d*) (see effsize::cohen.d() example in the Lab 5 key)
Outcome of an unpaired two-sample t-test

#### **Figure 3: Weigh and Hind Foot Length of Bonanza LTER Juvenile Snowshoe Hares**

```{r}
# Explore the relationship between juvenile snowshoe hare hind foot length (variable `hindft`, recorded in millimeters), and weight.

hare_foot <- hares_juvenile %>% 
  select(hindft, weight)

ggplot(data = hare_foot, aes(x = weight, y = hindft)) +
  geom_point(color = "slategray3") +
  geom_smooth(method = "lm") +
  theme_bw() +
  labs(x = "Weight (g)", y = "Hind Foot Length (mm)",
       title = "Snowshoe Hare Foot Length by Weight")
  
```

**Figure 3: Weigh and Hind Foot Length of Bonanza LTER Juvenile Snowshoe Hares.** *This graph shows the relationship between weight and hind foot length of snowshoe hares. The graph includes a simple line of best fit assuming a linear relationship between weight and foot length.*

```{r}
hares_lm <- lm(weight ~ hindft, data = hare_foot)

hares_lm_tidy <- tidy(hares_lm)

hares_lm_glance <- glance(hares_lm)
```

In 2 - 3 sentences below your figure, describe the outcome of your linear regression exploration (e.g. slope interpretation, R2 value, and Pearson's r correlation) and touch briefly on which assumption(s) of linear regression may be a concern, and additional thoughts you have about how well (or not wellâ€¦) the linear model describes the relationship. What worries you?

# **Summary**

# **Citations**
